{% extends "base.html" %}

{% block title %}Settings - EngageMeter{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="mb-8">
  <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between">
    <div>
      <h1 class="text-3xl font-bold text-base-content mb-2">‚öôÔ∏è Engagement Strategy Settings</h1>
      <p class="text-base-content/70">Customize your engagement scoring system and point values</p>
    </div>
    <div class="flex flex-wrap gap-2 mt-4 lg:mt-0">
      <a href="/" class="btn btn-outline btn-primary">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        Dashboard
      </a>
      <a href="/upload" class="btn btn-primary">
        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
        </svg>
        Upload CSV
      </a>
    </div>
  </div>
</div>

<!-- Current Point Values Display -->
<div class="card bg-base-100 shadow-lg border border-base-300 mb-8">
  <div class="card-body">
    <h2 class="card-title text-2xl mb-4">Current Engagement Strategy</h2>
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-6">
      <div class="stat bg-primary/5 border border-primary/20 rounded-box">
        <div class="stat-figure text-primary">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
          </svg>
        </div>
        <div class="stat-title text-primary">Likes</div>
        <div class="stat-value text-primary text-2xl">{{ current_points.like }}</div>
        <div class="stat-desc text-primary/70">points per like</div>
      </div>
      
      <div class="stat bg-secondary/5 border border-secondary/20 rounded-box">
        <div class="stat-figure text-secondary">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
          </svg>
        </div>
        <div class="stat-title text-secondary">Retweets</div>
        <div class="stat-value text-secondary text-2xl">{{ current_points.retweet }}</div>
        <div class="stat-desc text-secondary/70">points per retweet</div>
      </div>
      
      <div class="stat bg-accent/5 border border-accent/20 rounded-box">
        <div class="stat-figure text-accent">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
          </svg>
        </div>
        <div class="stat-title text-accent">Replies</div>
        <div class="stat-value text-accent text-2xl">{{ current_points.reply }}</div>
        <div class="stat-desc text-accent/70">points per reply</div>
      </div>
      
      <div class="stat bg-warning/5 border border-warning/20 rounded-box">
        <div class="stat-figure text-warning">
          <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
        </div>
        <div class="stat-title text-warning">Mentions</div>
        <div class="stat-value text-warning text-2xl">{{ current_points.mention }}</div>
        <div class="stat-desc text-warning/70">points per mention</div>
      </div>
    </div>
  </div>
</div>

<!-- Point Value Update Form -->
<div class="card bg-base-100 shadow-lg border border-base-300 mb-8">
  <div class="card-body">
    <h2 class="card-title text-2xl mb-4">Optimize Your Engagement Strategy</h2>
    <p class="text-base-content/70 mb-6">
      Adjust your point values to reflect the importance of different engagement types. 
      Higher values mean that type of engagement contributes more to your overall score.
    </p>
    
    <form method="POST" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Likes -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">‚ù§Ô∏è Likes</span>
          </label>
          <input
            type="number"
            name="like"
            value="{{ current_points.like }}"
            min="0"
            step="0.1"
            class="input input-bordered w-full"
            required
          />
          <label class="label">
            <span class="label-text-alt text-base-content/60">Points awarded for each like received</span>
          </label>
        </div>

        <!-- Retweets -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">üîÑ Retweets</span>
          </label>
          <input
            type="number"
            name="retweet"
            value="{{ current_points.retweet }}"
            min="0"
            step="0.1"
            class="input input-bordered w-full"
            required
          />
          <label class="label">
            <span class="label-text-alt text-base-content/60">Points awarded for each retweet received</span>
          </label>
        </div>

        <!-- Replies -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">üí¨ Replies</span>
          </label>
          <input
            type="number"
            name="reply"
            value="{{ current_points.reply }}"
            min="0"
            step="0.1"
            class="input input-bordered w-full"
            required
          />
          <label class="label">
            <span class="label-text-alt text-base-content/60">Points awarded for each reply received</span>
          </label>
        </div>

        <!-- Mentions -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">üì¢ Mentions</span>
          </label>
          <input
            type="number"
            name="mention"
            value="{{ current_points.mention }}"
            min="0"
            step="0.1"
            class="input input-bordered w-full"
            required
          />
          <label class="label">
            <span class="label-text-alt text-base-content/60">Points awarded for each mention received</span>
          </label>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="form-control pt-4">
        <button type="submit" class="btn btn-primary btn-lg">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          Update Strategy
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Strategy Presets -->
<div class="card bg-base-100 shadow-lg border border-base-300 mb-8">
  <div class="card-body">
    <h2 class="card-title text-2xl mb-4">üéØ Strategy Presets</h2>
    <p class="text-base-content/70 mb-6">
      Choose from pre-configured strategies or use them as starting points for your custom strategy.
    </p>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Viral Focus -->
      <div class="card bg-primary/5 border border-primary/20">
        <div class="card-body p-4">
          <h3 class="card-title text-lg text-primary">Viral Focus</h3>
          <p class="text-sm text-base-content/70 mb-3">Prioritize content that spreads quickly</p>
          <div class="space-y-2 text-xs text-base-content/70">
            <div class="flex justify-between">
              <span>Likes:</span>
              <span class="font-semibold">1.0</span>
            </div>
            <div class="flex justify-between">
              <span>Retweets:</span>
              <span class="font-semibold">3.0</span>
            </div>
            <div class="flex justify-between">
              <span>Replies:</span>
              <span class="font-semibold">2.0</span>
            </div>
            <div class="flex justify-between">
              <span>Mentions:</span>
              <span class="font-semibold">1.5</span>
            </div>
          </div>
          <button 
            onclick="applyPreset('viral')"
            class="btn btn-primary btn-sm w-full mt-3"
          >
            Apply Preset
          </button>
        </div>
      </div>

      <!-- Community Building -->
      <div class="card bg-secondary/5 border border-secondary/20">
        <div class="card-body p-4">
          <h3 class="card-title text-lg text-secondary">Community Building</h3>
          <p class="text-sm text-base-content/70 mb-3">Focus on meaningful interactions</p>
          <div class="space-y-2 text-xs text-base-content/70">
            <div class="flex justify-between">
              <span>Likes:</span>
              <span class="font-semibold">1.0</span>
            </div>
            <div class="flex justify-between">
              <span>Retweets:</span>
              <span class="font-semibold">2.0</span>
            </div>
            <div class="flex justify-between">
              <span>Replies:</span>
              <span class="font-semibold">4.0</span>
            </div>
            <div class="flex justify-between">
              <span>Mentions:</span>
              <span class="font-semibold">3.0</span>
            </div>
          </div>
          <button 
            onclick="applyPreset('community')"
            class="btn btn-secondary btn-sm w-full mt-3"
          >
            Apply Preset
          </button>
        </div>
      </div>

      <!-- Balanced Growth -->
      <div class="card bg-accent/5 border border-accent/20">
        <div class="card-body p-4">
          <h3 class="card-title text-lg text-accent">Balanced Growth</h3>
          <p class="text-sm text-base-content/70 mb-3">Equal weight for all engagement types</p>
          <div class="space-y-2 text-xs text-base-content/70">
            <div class="flex justify-between">
              <span>Likes:</span>
              <span class="font-semibold">1.0</span>
            </div>
            <div class="flex justify-between">
              <span>Retweets:</span>
              <span class="font-semibold">1.0</span>
            </div>
            <div class="flex justify-between">
              <span>Replies:</span>
              <span class="font-semibold">1.0</span>
            </div>
            <div class="flex justify-between">
              <span>Mentions:</span>
              <span class="font-semibold">1.0</span>
            </div>
          </div>
          <button 
            onclick="applyPreset('balanced')"
            class="btn btn-accent btn-sm w-full mt-3"
          >
            Apply Preset
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Strategy Impact Calculator -->
<div class="card bg-base-100 shadow-lg border border-base-300 mb-8">
  <div class="card-body">
    <h2 class="card-title text-2xl mb-4">üßÆ Strategy Impact Calculator</h2>
    <p class="text-base-content/70 mb-6">
      See how your current strategy would score a sample tweet with different engagement levels.
    </p>
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Sample Tweet Input -->
      <div class="space-y-4">
        <h3 class="text-lg font-semibold">Sample Tweet Engagement</h3>
        <div class="form-control">
          <label class="label">
            <span class="label-text">Likes</span>
          </label>
          <input type="number" id="sample-likes" value="10" min="0" class="input input-bordered" />
        </div>
        <div class="form-control">
          <label class="label">
            <span class="label-text">Retweets</span>
          </label>
          <input type="number" id="sample-retweets" value="5" min="0" class="input input-bordered" />
        </div>
        <div class="form-control">
          <label class="label">
            <span class="label-text">Replies</span>
          </label>
          <input type="number" id="sample-replies" value="3" min="0" class="input input-bordered" />
        </div>
        <div class="form-control">
          <label class="label">
            <span class="label-text">Mentions</span>
          </label>
          <input type="number" id="sample-mentions" value="2" min="0" class="input input-bordered" />
        </div>
      </div>

      <!-- Score Results -->
      <div class="space-y-4">
        <h3 class="text-lg font-semibold">Calculated Score</h3>
        <div class="stats shadow">
          <div class="stat">
            <div class="stat-title">Total Score</div>
            <div class="stat-value text-primary" id="total-score">0</div>
            <div class="stat-desc">Based on current strategy</div>
          </div>
        </div>
        
        <div class="card bg-base-200">
          <div class="card-body p-4">
            <h4 class="font-semibold mb-3">Score Breakdown</h4>
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span>Likes Score:</span>
                <span id="likes-score">0</span>
              </div>
              <div class="flex justify-between">
                <span>Retweets Score:</span>
                <span id="retweets-score">0</span>
              </div>
              <div class="flex justify-between">
                <span>Replies Score:</span>
                <span id="replies-score">0</span>
              </div>
              <div class="flex justify-between">
                <span>Mentions Score:</span>
                <span id="mentions-score">0</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Tips and Best Practices -->
<div class="card bg-base-100 shadow-lg border border-base-300">
  <div class="card-body">
    <h2 class="card-title text-2xl mb-4">üí° Strategy Tips & Best Practices</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="space-y-4">
        <div class="card bg-info/5 border border-info/20">
          <div class="card-body p-4">
            <h4 class="font-semibold text-info">Understanding Point Values</h4>
            <p class="text-sm text-base-content/70">
              Higher point values mean that type of engagement contributes more to your overall score. 
              Consider what's most valuable for your goals.
            </p>
          </div>
        </div>
        
        <div class="card bg-success/5 border border-success/20">
          <div class="card-body p-4">
            <h4 class="font-semibold text-success">Viral vs. Community</h4>
            <p class="text-sm text-base-content/70">
              Viral strategies prioritize retweets and shares, while community strategies focus on replies 
              and meaningful interactions.
            </p>
          </div>
        </div>
      </div>
      
      <div class="space-y-4">
        <div class="card bg-warning/5 border border-warning/20">
          <div class="card-body p-4">
            <h4 class="font-semibold text-warning">Testing & Iteration</h4>
            <p class="text-sm text-base-content/70">
              Start with balanced values, then adjust based on your content performance and goals. 
              Monitor how changes affect your engagement patterns.
            </p>
          </div>
        </div>
        
        <div class="card bg-primary/5 border border-primary/20">
          <div class="card-body p-4">
            <h4 class="font-semibold text-primary">Content Strategy Alignment</h4>
            <p class="text-sm text-base-content/70">
              Align your point values with your content strategy. If you want more discussions, 
              increase reply points. If you want more reach, increase retweet points.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Strategy presets
const presets = {
  viral: { like: 1.0, retweet: 3.0, reply: 2.0, mention: 1.5 },
  community: { like: 1.0, retweet: 2.0, reply: 4.0, mention: 3.0 },
  balanced: { like: 1.0, retweet: 1.0, reply: 1.0, mention: 1.0 }
};

function applyPreset(presetName) {
  const preset = presets[presetName];
  if (preset) {
    document.querySelector('input[name="like"]').value = preset.like;
    document.querySelector('input[name="retweet"]').value = preset.retweet;
    document.querySelector('input[name="reply"]').value = preset.reply;
    document.querySelector('input[name="mention"]').value = preset.mention;
    
    // Show success message
    const alert = document.createElement('div');
    alert.className = 'alert alert-success mt-4';
    alert.innerHTML = `
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <div>
        <h3 class="font-bold">Preset Applied!</h3>
        <div class="text-sm">${presetName.charAt(0).toUpperCase() + presetName.slice(1)} strategy has been applied to the form.</div>
      </div>
    `;
    
    const form = document.querySelector('form');
    form.parentNode.insertBefore(alert, form.nextSibling);
    
    // Remove alert after 3 seconds
    setTimeout(() => alert.remove(), 3000);
    
    // Update calculator
    updateCalculator();
  }
}

// Strategy impact calculator
function updateCalculator() {
  const likes = parseInt(document.getElementById('sample-likes').value) || 0;
  const retweets = parseInt(document.getElementById('sample-retweets').value) || 0;
  const replies = parseInt(document.getElementById('sample-replies').value) || 0;
  const mentions = parseInt(document.getElementById('sample-mentions').value) || 0;
  
  const likePoints = parseFloat(document.querySelector('input[name="like"]').value) || 0;
  const retweetPoints = parseFloat(document.querySelector('input[name="retweet"]').value) || 0;
  const replyPoints = parseFloat(document.querySelector('input[name="reply"]').value) || 0;
  const mentionPoints = parseFloat(document.querySelector('input[name="mention"]').value) || 0;
  
  const likesScore = likes * likePoints;
  const retweetsScore = retweets * retweetPoints;
  const repliesScore = replies * replyPoints;
  const mentionsScore = mentions * mentionPoints;
  const totalScore = likesScore + retweetsScore + repliesScore + mentionsScore;
  
  document.getElementById('likes-score').textContent = likesScore.toFixed(1);
  document.getElementById('retweets-score').textContent = retweetsScore.toFixed(1);
  document.getElementById('replies-score').textContent = repliesScore.toFixed(1);
  document.getElementById('mentions-score').textContent = mentionsScore.toFixed(1);
  document.getElementById('total-score').textContent = totalScore.toFixed(1);
}

// Add event listeners for calculator
document.addEventListener('DOMContentLoaded', function() {
  const inputs = ['sample-likes', 'sample-retweets', 'sample-replies', 'sample-mentions'];
  inputs.forEach(id => {
    document.getElementById(id).addEventListener('input', updateCalculator);
  });
  
  const strategyInputs = ['input[name="like"]', 'input[name="retweet"]', 'input[name="reply"]', 'input[name="mention"]'];
  strategyInputs.forEach(selector => {
    document.querySelector(selector).addEventListener('input', updateCalculator);
  });
  
  // Initial calculation
  updateCalculator();
});
</script>
{% endblock %}
